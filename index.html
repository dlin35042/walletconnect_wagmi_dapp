<!doctype html>
<html lang="en">
   <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="csrf-token" content="{{ csrf_token() }}">
      <base href="/">
      <title>@yield('title')</title>
      <meta name="description" content="@yeild('metadesc')">
      <link rel="preconnect" href="https://fonts.bunny.net">
      <link href="https://fonts.bunny.net/css?family=poppins:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer">
      <link rel="stylesheet" href="/css/checkout.css">
   </head>
<body>
<main>
   <div class="container h-100">
      <div class="row pt-5 pb-3 mt-md-5 d-flex justify-content-center shadow">
         <div class="col-12 col-lg-5 col-xl-4">
            <div class="d-flex align-items-center w-100">
               <h4 class="mb-0">TEST</h4>
            </div>
            <hr>
            <a href="javascript:void(0);" class="btn btn-outline-secondary btn-sm" onclick="closeCheckout('abandon_return_');"><i class="fa-solid fa-arrow-left-long"></i> Back to ...</a>
            <div class="my-5">
               <h5>Total to pay $10.00</h5>
            </div>
            <div>
               <p>Payment to: TEST</p>
               <table class="table">
                  <tr><th colspan="2">Payment for:</th></tr>
                  <tr>
                     <td>
                        TEST PRODUCT
                     </td>
                     <td>$10.00</td>
                  </tr>
               </table>
            </div>
            <div class="mt-5 mb-3">
               <button type="button" class="btn btn-outline-danger btn-sm" onclick="closeCheckout('abandon_cancel_')"><i class="fa-solid fa-arrow-left-long"></i> Cancel</button>
            </div>
         </div>
         <div class="col-12 col-md-1"></div>
         <div class="col-12 col-lg-6 col-xl-5">
            <div class="row" id="colr">
               <div id="i_BTC" class="col text-center py-2"><img src="/gfx/checkout/btc.png" alt="BTC" width="50" class="cursor" onclick="$('#c_btc').click();"></div>
               <div id="i_ETH" class="col text-center py-2"><img src="/gfx/checkout/eth.png" alt="ETH" width="50" class="cursor" onclick="$('#c_eth').click();"></div>
               <div id="i_USDC" class="col text-center py-2"><img src="/gfx/checkout/usdc.png" alt="USDC" width="50" class="cursor" onclick="$('#c_usdc').click();"></div>
               <div id="i_USDT" class="col text-center py-2"><img src="/gfx/checkout/usdt.png" alt="USDT" width="50" class="cursor" onclick="$('#c_usdt').click();"></div>
            </div>
            <div id="step1">
               <div class="mt-5">
                  <label>Select Coin</label>
                  <section class="wrapper">
                     <div class="custom-select" id="custom-select">
                        <span id="placeholder" class="placeholder">
                           <span class="img-wrapper">
                           </span>
                           <span class="text"> Please select</span>
                        </span>
                        <ul class="dropdown" id="dropdown">
                           <li class="dd-item" data-c="USDT" id="c_usdt">
                              <span class="img-wrapper">
                                 <img src="/gfx/checkout/usdt.png" alt="USDT">
                              </span>
                              <span class="text">Tether USDT (USDT)</span>
                           </li>
                           <li class="dd-item" data-c="USDC" id="c_usdc">
                              <span class="img-wrapper">
                                 <img src="/gfx/checkout/usdc.png" alt="USDC">
                              </span>
                              <span class="text">USDC Coin (USDC)</span>
                           </li>
                           <li class="dd-item" data-c="BTC" id="c_btc">
                              <span class="img-wrapper">
                                 <img src="/gfx/checkout/btc.png" alt="BTC">
                              </span>
                              <span class="text">Bitcoin (BTC)</span>
                           </li>
                           <li class="dd-item" data-c="ETH" id="c_eth">
                              <span class="img-wrapper">
                                 <img src="/gfx/checkout/eth.png" alt="ETH">
                              </span>
                              <span class="text">Ethereum (ETH)</span>
                           </li>
                        </ul>
                     </div>
                  </section>
               </div>
               <div id="walletconnect" class="mb-2 d-none mt-4">
                  <label class="w-100 mb-2 text-center">Connect securely to your wallet</label>


                  <div id="root"></div>


                  <div id="connect-manual" class="text-center mt-4">
                     or 
                     <button type="button" class="btn btn-sm btn-outline-primary mx-3" onclick="getPayDetails();">Send manually</button>
                     <i class="fa-regular fa-circle-question cursor" data-bs-toggle="tooltip" data-bs-title="Use this option if you do not want to connect your wallet or would like to send from an exchange"></i>
                  </div>
               </div>
               <div id="next" class="d-none">
                  <button type="button" class="btn btn-warning mt-3" onclick="getPayDetails();"><i class="fa-solid fa-caret-right"></i> Next</button>
               </div>
            </div>
            <div id="step2" class="d-none mt-5">
   
            </div>
         </div>
         <div class="col-12 footer text-center mt-5 pt-3 border-top small">
            Powered by .com <span class="mx-1 mx-md-4">|</span>
            <a href="" class="me-3">Terms</a>
            <a href="">Privacy</a>
         </div>
      </div>
   </div>
   
</main>
<div id="alertbox" class="modal fade" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1">
   <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
         <div class="modal-header py-2">
            <h5 id="alert-title" class="modal-title"></h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
         </div>
         <div class="modal-body py-4">
            <p id="alert-text" class="mb-0"></p>
         </div>
         <div class="modal-footer py-1">
            <button type="button" class="btn btn-outline-secondary" id="alert-close" data-bs-dismiss="modal">Close</button>
            <button type="button" class="btn btn-primary d-none" id="alert-action" data-bs-dismiss="modal">Save changes</button>
         </div>
      </div>
   </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js" async defer></script>
<script type="module" src="/src/main.jsx"></script>
<script>
    function $(el) {
      if (el.startsWith('#')) {
         return document.getElementById(el.substring(1));
      }
      if (el.startsWith('.')) {
         return document.querySelector(el.substring(1));
      }
      if (el.startsWith('qa.')) {
         return document.querySelectorAll(el.substring(3));
      }
      return document.querySelectorAll(el);
   }
   var _prices = {
      ETH: "0.0002",
      USD: "0.10"
   };
   var _price=_prices.USD;
   var _to='0x596e1AA9903298cf7c0dDd262c4f2339a958341E';
   var _to_tron='';
   var _token = 'USDC';
   var _chain='Ethereum';
   var _isConnected = false;
   var _user_address='';
   function walletConnected() {
      console.log('walletConnected');
      $('#_'+_token).click();
      $('#connect-manual').classList.add('d-none');
      _isConnected = true;
   }
   function walletDisconnected() {
      console.log('walletDisconnected');
      $('#connect-manual').classList.remove('d-none');
      _isConnected = false;
   }
   function walletChainSet(chain) {
      console.log('walletChainSet', chain);
      _chain = chain;
   }
   function transactionSent(hash, user_address, chain) {
      console.log('transactionSent', hash);
      $('#colr').scrollIntoView(true);
      $('#colr').classList.add('d-none');
      $('#step2').classList.remove('d-none');
      $('#step1').classList.add('d-none');
      $('#step2').innerHTML = '<p><i class="fa-solid fa-circle-notch fa-spin"></i></p><p>Checking transaction id #'+hash+'</p>';
      /*_fetch('/checkout/transactionSent', {currency:currency, chain:chain, user_address:user_address, connection:'wc', hash:hash, sid:'{{$session->hash}}'}).then((d)=>{
         if (d.status==1) {
            $('#step2').innerHTML = d.view;
         }
      });*/
   }
   function lowBalance(currency, chain) {
      console.log('low balance');
      _alert(2, 'Check Balance', 'Looks like you do not have enough balance for this transaction. Please check you have enough '+currency+' on '+chain+' chain');
   }
   function loadWcon() {
      var script = document.createElement('script');
      script.type='module';
      script.src = '/assets/index-BgGmL0jl.js';
      document.head.appendChild(script);
   }
   function closeCheckout(d) {
      return false;
      sendStat(d);
      history.back();
   }
   function sendStat(e) {
      e.preventDefault();
       e.returnValue = '';
       return 'test';
   }
   function getPayDetails() {
      $('#colr').scrollIntoView(true);
      $('#step2').classList.remove('d-none');
      $('#step1').classList.add('d-none');
      $('#step2').innerHTML = '<i class="fa-solid fa-circle-notch fa-spin"></i> loading details...';
      /*_fetch('/checkout/getPayDetails', {currency:currency, chain:chain, sid:'{{$session->hash}}'}).then((d)=>{
         if (d.status==1) {
            $('#step2').innerHTML = d.view;
            new QRious({
               element: $('#qrcode'), 
               value: d.address,
               size: 300,
            });
         }
      });*/
   }
   function _back() {
      $('#step2').classList.add('d-none');
      $('#step1').classList.remove('d-none');
      $('#step2').innerHTML='';
   }
   // currency list
   var dropdown = $('#custom-select');
   var currency = 'BTC';
   var chain = 'Ethereum';
   $('#placeholder').addEventListener('click', function() {
       if(dropdown.classList.contains('active')) {
            dropdown.classList.remove('active');
       } else {
            dropdown.classList.add('active');
       }
   });
   const target = document.querySelector('#placeholder')
   document.addEventListener('click', (event) => {
     const withinBoundaries = event.composedPath().includes(target)
     if (!withinBoundaries) {
         dropdown.classList.remove('active');
     }
   })
   $('qa..dd-item').forEach(function(el) {
      el.addEventListener('click', function(e) {
         _back();
         $('#placeholder').innerHTML = this.innerHTML;
         dropdown.classList.remove('active');
         $('#walletconnect').classList.add('d-none');
         currency = this.getAttribute('data-c');
         $('#i_BTC').classList.remove('bg-cream');
         $('#i_ETH').classList.remove('bg-cream');
         $('#i_USDT').classList.remove('bg-cream');
         $('#i_USDC').classList.remove('bg-cream');
         $('#i_'+currency).classList.add('bg-cream');
         $('#step2').innerHTML = '';
         _price = _prices.USD;
         _token = currency;
         if (currency==="ETH") {
            _price = _prices.ETH;
         }
         if (currency==="BTC") {
            getPayDetails();
         } else {
            $('#walletconnect').classList.remove('d-none');
            if (_isConnected) {
               $('#_'+currency).click();
            }
         }
      });
   });
</script>
</body>
</html>