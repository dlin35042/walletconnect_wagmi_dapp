<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="csrf-token" content="{{ csrf_token() }}" />
    <base href="/" />
    <title></title>
    <meta name="description" content="@yeild('metadesc')" />
    <link rel="preconnect" href="https://fonts.bunny.net" />
    <link
      href="https://fonts.bunny.net/css?family=poppins:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css"
      integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
      integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link rel="stylesheet" href="/css/checkout.css" />
  </head>
  <body>
    <main>
      <div class="container h-100">
        <div class="row pt-5 pb-3 mt-md-5 d-flex justify-content-center shadow">
          <div class="col-12 col-lg-5 col-xl-4">
            <div class="d-flex align-items-center w-100">
              <h4 class="mb-0">TEST</h4>
            </div>
            <hr />
            <a
              href="javascript:void(0);"
              class="btn btn-outline-secondary btn-sm"
              onclick="closeCheckout('abandon_return_');"
              ><i class="fa-solid fa-arrow-left-long"></i> Back to ...</a
            >
            <div class="my-5">
              <h5>Total to pay $10.00</h5>
            </div>
            <div>
              <p>Payment to: TEST</p>
              <table class="table">
                <tr>
                  <th colspan="2">Payment for:</th>
                </tr>
                <tr>
                  <td>TEST PRODUCT</td>
                  <td>$10.00</td>
                </tr>
              </table>
            </div>
            <div class="mt-5 mb-3">
              <button
                type="button"
                class="btn btn-outline-danger btn-sm"
                onclick="closeCheckout('abandon_cancel_')"
              >
                <i class="fa-solid fa-arrow-left-long"></i> Cancel
              </button>
            </div>
          </div>
          <div class="col-12 col-md-1"></div>
          <div class="col-12 col-lg-6 col-xl-5">
            <div id="connect-wallet-section">
              <div>
                <label>Select Coin</label>
                <div class="row mt-1" id="colr">
                  <div
                    id="i_ETH"
                    class="col token-item text-center py-2"
                    onclick="selectToken('ETH')"
                  >
                    <img src="/gfx/checkout/eth.png" alt="ETH" width="50" />
                  </div>
                  <div
                    id="i_USDC"
                    class="col token-item text-center py-2"
                    onclick="selectToken('USDC')"
                  >
                    <img src="/gfx/checkout/usdc.png" alt="USDC" width="50" />
                  </div>
                  <div
                    id="i_USDT"
                    class="col token-item text-center py-2"
                    onclick="selectToken('USDT')"
                  >
                    <img src="/gfx/checkout/usdt.png" alt="USDT" width="50" />
                  </div>
                </div>
              </div>
              <div>
                <div class="my-4 pointer-events-none" id="select-chain-section">
                  <label>Select Chain</label>
                  <section class="wrapper">
                    <div class="custom-select" id="custom-chain-select">
                      <span id="placeholder" class="placeholder">
                        <span class="img-wrapper"> </span>
                        <span class="text"> Please select</span>
                      </span>
                      <ul class="dropdown" id="dropdown">
                        <li
                          class="chain-item"
                          data-c="ETHEREUM"
                          id="c_ETHEREUM"
                          onclick="selectChain('ETHEREUM')"
                        >
                          <span class="img-wrapper">
                            <img src="/gfx/checkout/eth.png" alt="ETHEREUM" />
                          </span>
                          <span class="text">ETHEREUM</span>
                        </li>
                        <li
                          class="chain-item"
                          data-c="BASE"
                          id="c_BASE"
                          onclick="selectChain('BASE')"
                        >
                          <span class="img-wrapper">
                            <img src="/gfx/checkout/base.png" alt="BASE" />
                          </span>
                          <span class="text">BASE</span>
                        </li>
                        <li
                          class="chain-item"
                          data-c="ARBITRUM"
                          id="c_ARBITRUM"
                          onclick="selectChain('ARBITRUM')"
                        >
                          <span class="img-wrapper">
                            <img
                              src="/gfx/checkout/arbitrum.png"
                              alt="arbitrum"
                            />
                          </span>
                          <span class="text">ARBITRUM</span>
                        </li>
                        <li
                          class="chain-item"
                          data-c="POLYGON"
                          id="c_POLYGON"
                          onclick="selectChain('POLYGON')"
                        >
                          <span class="img-wrapper">
                            <img
                              src="/gfx/checkout/polygon.png"
                              alt="POLYGON"
                            />
                          </span>
                          <span class="text">POLYGON</span>
                        </li>
                        <li
                          class="chain-item"
                          data-c="TRON"
                          id="c_TRON"
                          onclick="selectChain('TRON')"
                        >
                          <span class="img-wrapper">
                            <img src="/gfx/checkout/tron.png" alt="TRON" />
                          </span>
                          <span class="text">TRON</span>
                        </li>
                      </ul>
                    </div>
                  </section>
                </div>

                <div class="pointer-events-none" id="root"></div>
              </div>
            </div>
            <div class="d-none" id="transaction-info-section">
              <div id="transaction-detail"></div>
              <div class="d-flex justify-content-center">
                <button class="btn btn-primary" onclick="confirmTransaction()">
                  Confirm
                </button>
              </div>
            </div>
          </div>
          <div class="col-12 footer text-center mt-5 pt-3 border-top small">
            Powered by .com <span class="mx-1 mx-md-4">|</span>
            <a href="" class="me-3">Terms</a>
            <a href="">Privacy</a>
          </div>
        </div>
      </div>
    </main>

    <div
      id="alertbox"
      class="modal fade"
      data-bs-backdrop="static"
      data-bs-keyboard="false"
      tabindex="-1"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header py-2">
            <h5 id="alert-title" class="modal-title"></h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body py-4">
            <p id="alert-text" class="mb-0"></p>
          </div>
          <div class="modal-footer py-1">
            <button
              type="button"
              class="btn btn-outline-secondary"
              id="alert-close"
              data-bs-dismiss="modal"
            >
              Close
            </button>
            <button
              type="button"
              class="btn btn-primary d-none"
              id="alert-action"
              data-bs-dismiss="modal"
            >
              Save changes
            </button>
          </div>
        </div>
      </div>
    </div>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"
      async
      defer
    ></script>

    <script type="module" src="/src/main.jsx"></script>
    <script>
      function $(el) {
        if (el.startsWith("#")) {
          return document.getElementById(el.substring(1));
        }
        if (el.startsWith(".")) {
          return document.querySelector(el.substring(1));
        }
        if (el.startsWith("qa.")) {
          return document.querySelectorAll(el.substring(3));
        }
        return document.querySelectorAll(el);
      }

      var _prices = {
        ETH: "0.0002",
        USD: "0.10",
      };
      var _price = _prices.USD;
      var _to = "0x596e1AA9903298cf7c0dDd262c4f2339a958341E";
      var _to_tron = "";
      var _token = "";
      var _chain = "";
      var _isConnected = false;
      var _user_address = "";

      function selectToken(token) {
        console.log("Selected Coin: " + token);
        _token = token;
        const tokens = document.getElementsByClassName("token-item");
        for (let i = 0; i < tokens.length; i++) {
          tokens[i].style.border = "1px solid white";
        }
        document.getElementById("i_" + token).style.border =
          "1px solid #85a1d3";

        $("#c_POLYGON").classList.remove("d-none");
        $("#c_BASE").classList.remove("d-none");

        if (token === "ETH") {
          _price = _prices.ETH;

          $("#c_POLYGON").classList.add("d-none");
        } else {
          _price = _prices.USD;
        }

        // Hide base chain when USDT is selected
        if (token === "USDT") {
          $("#c_BASE").classList.add("d-none");
        }

        console.log("token: " + token);

        $("#_" + token).click();
        $("#select-chain-section").classList.remove("pointer-events-none");
      }

      function selectChain(chain) {
        _chain = chain;
        $("#_chain_value").value = chain;
        $("#_chain").click();
        $("#root").classList.remove("pointer-events-none");
      }

      // Events from App
      function walletConnected() {
        console.log("walletConnected");
        _isConnected = true;
      }
      function walletDisconnected() {
        console.log("walletDisconnected");
        _isConnected = false;
      }
      function lowBalance(currency, chain) {
        alert("Insufficient balance in " + currency + " on " + chain);
      }
      function transactionSent(hash, user_address, chain) {
        console.log("transactionSent", hash);
        $("#transaction-infor-section").classList.remove("d-none");
        $("connect-wallet-section").classList.add("d-none");

        $("#transaction-detail").innerHTML =
          '<p><i class="fa-solid fa-circle-notch fa-spin"></i></p><p>Checking transaction id #' +
          hash +
          "</p>";
      }
      function confirmTransaction() {
        $("#transaction-infor-section").classList.add("d-none");
        $("#transaction-detail").innerHTML = "";
        $("connect-wallet-section").classList.remove("d-none");
      }

      // Dropdown
      var dropdown = $("#custom-chain-select");
      $("#placeholder").addEventListener("click", function () {
        if (dropdown.classList.contains("active")) {
          dropdown.classList.remove("active");
        } else {
          dropdown.classList.add("active");
        }
      });

      const target = document.querySelector("#placeholder");
      document.addEventListener("click", (event) => {
        const withinBoundaries = event.composedPath().includes(target);
        if (!withinBoundaries) {
          dropdown.classList.remove("active");
        }
      });
      $("qa..chain-item").forEach(function (el) {
        el.addEventListener("click", function (e) {
          $("#placeholder").innerHTML = this.innerHTML;
          dropdown.classList.remove("active");
        });
      });
    </script>
  </body>
</html>
